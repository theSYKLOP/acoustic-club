import{a as L,_ as N}from"./CiWreWkq.js";import{e as B,h as x,p as I,w as $,o as i,a as e,c,l as k,q as h,t as u,k as r,r as z,n as A,b as T,F as y,s as M,i as O}from"#entry";import{u as H}from"./BZIEon5x.js";import"./DlAUqK2U.js";const P={class:"flex flex-col items-center"},F={key:0,class:"w-6 h-6 sm:w-8 sm:h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},U={key:1,class:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},q={class:"text-center text-sm sm:text-base text-gray-700 leading-relaxed"},G={key:0,class:"text-center text-xs sm:text-sm text-gray-500 mt-2"},Z=["onClick"],J=["onClick","disabled"],K={key:0,class:"spinner-small"},Q=B({__name:"ConfirmModal",props:{isOpen:{type:Boolean},title:{},subtitle:{},message:{},details:{},confirmText:{default:"Confirmer"},isDestructive:{type:Boolean,default:!1}},emits:["close","confirm"],setup(l,{emit:a}){const p=a,m=x(!1),b=async n=>{m.value=!0;try{await new Promise(d=>setTimeout(d,300)),p("confirm"),n()}finally{m.value=!1}};return(n,d)=>{const g=L;return i(),I(g,{"is-open":l.isOpen,title:l.title,subtitle:l.subtitle,"close-on-backdrop":!l.isDestructive,"close-on-escape":!l.isDestructive,onClose:d[0]||(d[0]=f=>p("close"))},{footer:$(({close:f})=>[e("button",{onClick:f,class:"btn-outline flex-1 sm:flex-none"}," Annuler ",8,Z),e("button",{onClick:_=>b(f),disabled:r(m),class:h(["flex-1 sm:flex-none flex items-center justify-center gap-2",l.isDestructive?"btn-danger":"btn-primary"])},[r(m)?(i(),c("span",K)):k("",!0),e("span",null,u(r(m)?"Traitement...":l.confirmText),1)],10,J)]),default:$(()=>[e("div",P,[e("div",{class:h(["w-12 h-12 sm:w-16 sm:h-16 rounded-full flex items-center justify-center mb-4 sm:mb-6",l.isDestructive?"bg-red-100":"bg-blue-100"])},[l.isDestructive?(i(),c("svg",F,[...d[1]||(d[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4v2m0 0a8 8 0 100-16 8 8 0 000 16z"},null,-1)])])):(i(),c("svg",U,[...d[2]||(d[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])]))],2),e("p",q,u(l.message),1),l.details?(i(),c("p",G,u(l.details),1)):k("",!0)])]),_:1},8,["is-open","title","subtitle","close-on-backdrop","close-on-escape"])}}}),W=Object.assign(Q,{__name:"ConfirmModal"}),X={key:0,class:"flex flex-col items-center justify-center py-12 lg:py-20"},Y={class:"hidden lg:block card-base overflow-hidden"},ee={class:"overflow-x-auto"},te={class:"table-base"},se={class:"font-bold"},ne={class:"text-gray-600"},oe={class:"flex items-center gap-2"},le=["onClick"],ae=["onClick"],ie=["onClick"],re={class:"lg:hidden space-y-3"},ce=["onClick"],de={class:"flex items-start justify-between mb-3"},ue={class:"font-bold text-lg mb-1"},me={class:"text-sm text-gray-600"},be={class:"flex items-center justify-between"},fe={class:"text-sm text-gray-500"},pe={class:"flex items-center gap-2"},ve=["onClick"],ge=["onClick"],xe={key:0,class:"text-center py-12"},ke=B({__name:"tables",setup(l){const a=H(),p=x(!0),m=x(!1),b=x(null),n=z({isOpen:!1,mode:"view",table:null}),d=()=>{n.isOpen=!0,n.mode="create",n.table=null},g=o=>{n.isOpen=!0,n.mode="view",n.table=o},f=o=>{n.isOpen=!0,n.mode="edit",n.table=o},_=()=>{n.isOpen=!1},R=async o=>{try{n.mode==="create"?await a.createTable({number:o.number,capacity:o.capacity,location:o.location}):n.table&&await a.updateTable(n.table.id,o),await a.fetchTables(),_()}catch(t){console.error("Error saving table:",t)}},D=async(o,t)=>{try{await a.updateTable(o.toString(),{status:t}),await a.fetchTables()}catch(C){console.error("Error changing status:",C)}},w=o=>{b.value=o,m.value=!0},j=async()=>{b.value&&(await a.deleteTable(b.value.id),await a.fetchTables(),m.value=!1,b.value=null)},E=o=>({LIBRE:"badge-success",OCCUPEE:"badge-danger",RESERVEE:"badge-warning",HORS_SERVICE:"badge-neutral"})[o],S=o=>({LIBRE:"Libre",OCCUPEE:"Occupée",RESERVEE:"Réservée",HORS_SERVICE:"Hors service"})[o];return A(async()=>{await a.fetchTables(),p.value=!1}),(o,t)=>{const C=N,V=W;return i(),c("div",null,[t[7]||(t[7]=e("div",{class:"lg:hidden mb-6"},[e("h1",{class:"text-2xl font-bold mb-4"},"Gestion des tables")],-1)),e("div",{class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-4 lg:mb-6"},[t[2]||(t[2]=e("h2",{class:"hidden lg:block text-xl lg:text-2xl font-bold"},"Liste des tables",-1)),e("button",{onClick:d,class:"w-full sm:w-auto btn-primary text-sm lg:text-base"},[...t[1]||(t[1]=[e("span",{class:"text-lg"},"+",-1),e("span",null,"Nouvelle table",-1)])])]),r(p)?(i(),c("div",X,[...t[3]||(t[3]=[e("div",{class:"spinner mb-3"},null,-1),e("span",{class:"text-sm lg:text-base text-gray-600"},"Chargement...",-1)])])):(i(),c(y,{key:1},[e("div",Y,[e("div",ee,[e("table",te,[t[4]||(t[4]=e("thead",null,[e("tr",null,[e("th",{class:"w-32"},"Numéro"),e("th",{class:"w-32"},"Capacité"),e("th",null,"Zone"),e("th",{class:"w-40"},"Statut"),e("th",{class:"w-32"},"Actions")])],-1)),e("tbody",null,[(i(!0),c(y,null,M(r(a).tables,s=>(i(),c("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",se,"Table "+u(s.number),1),e("td",null,"👥 "+u(s.capacity)+" pers.",1),e("td",ne,u(s.location||"-"),1),e("td",null,[e("span",{class:h(["badge-base",E(s.status)])},u(S(s.status)),3)]),e("td",null,[e("div",oe,[e("button",{onClick:v=>g(s),class:"btn-ghost btn-sm btn-icon",title:"Voir les détails"}," 👁️ ",8,le),e("button",{onClick:v=>f(s),class:"btn-ghost btn-sm btn-icon",title:"Modifier"}," ✏️ ",8,ae),e("button",{onClick:v=>w(s),class:"btn-ghost btn-sm btn-icon text-red-600 hover:bg-red-50",title:"Supprimer"}," 🗑️ ",8,ie)])])]))),128))])])])]),e("div",re,[(i(!0),c(y,null,M(r(a).tables,s=>(i(),c("div",{key:s.id,onClick:v=>g(s),class:"card-base p-4 cursor-pointer hover:shadow-md transition-shadow"},[e("div",de,[e("div",null,[e("h3",ue,"Table "+u(s.number),1),e("p",me," 👥 "+u(s.capacity)+" personnes ",1)]),e("span",{class:h(["badge-base text-xs",E(s.status)])},u(S(s.status)),3)]),e("div",be,[e("div",fe," 📍 "+u(s.location||"Non défini"),1),e("div",pe,[e("button",{onClick:O(v=>f(s),["stop"]),class:"p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Modifier"}," ✏️ ",8,ve),e("button",{onClick:O(v=>w(s),["stop"]),class:"p-2 rounded-lg hover:bg-red-50 text-red-600 transition-colors",title:"Supprimer"}," 🗑️ ",8,ge)])])],8,ce))),128)),r(a).tables.length===0?(i(),c("div",xe,[t[5]||(t[5]=e("div",{class:"text-5xl mb-3"},"🪑",-1)),t[6]||(t[6]=e("p",{class:"text-gray-600 mb-4"},"Aucune table créée",-1)),e("button",{onClick:d,class:"btn-primary"}," Créer la première table ")])):k("",!0)])],64)),T(C,{"is-open":r(n).isOpen,mode:r(n).mode,table:r(n).table,onClose:_,onSave:R,onStatusChange:D},null,8,["is-open","mode","table"]),T(V,{"is-open":r(m),title:"Supprimer la table",subtitle:"Cette action est irréversible",message:`Êtes-vous sûr de vouloir supprimer la table ${r(b)?.number} ?`,details:"Toutes les données associées seront également supprimées.","confirm-text":"Supprimer","is-destructive":!0,onClose:t[0]||(t[0]=s=>m.value=!1),onConfirm:j},null,8,["is-open","message"])])}}});export{ke as default};
