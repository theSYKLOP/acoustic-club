import{e as j,n as G,z as W,A as S,p as T,o as r,b as V,w as v,c as d,l as m,T as M,a as e,t as u,B as _,i as X,C as Y,h as k,r as I,m as h,k as n,q as g,F as w,s as Z,j as R,v as O}from"#entry";import{_ as ee}from"./DlAUqK2U.js";const te={key:0,class:"fixed inset-x-0 bottom-0 sm:inset-0 sm:flex sm:items-center sm:justify-center z-50 pointer-events-none"},se={class:"sticky top-0 bg-white border-b border-gray-200 rounded-t-2xl sm:rounded-t-2xl"},ae={class:"px-4 sm:px-6 py-4 sm:py-5 flex items-center justify-between"},le={class:"flex-1"},oe={class:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900"},ne={key:0,class:"text-xs sm:text-sm text-gray-600 mt-1"},ie={class:"px-4 sm:px-6 py-4 sm:py-6"},re={key:0,class:"sticky bottom-0 bg-white border-t border-gray-200 px-4 sm:px-6 py-3 sm:py-4 flex flex-col-reverse sm:flex-row gap-2 sm:gap-3 justify-end"},de=j({__name:"BaseModal",props:{isOpen:{type:Boolean},title:{},subtitle:{},closeOnBackdrop:{type:Boolean,default:!0},closeOnEscape:{type:Boolean,default:!0}},emits:["close"],setup(a,{emit:E}){const s=a,y=E,x=()=>{y("close")},p=()=>{s.closeOnBackdrop&&x()};return G(()=>{const i=c=>{c.key==="Escape"&&s.closeOnEscape&&s.isOpen&&x()};window.addEventListener("keydown",i),W(()=>{window.removeEventListener("keydown",i)})}),S(()=>s.isOpen,i=>{i?document.body.style.overflow="hidden":document.body.style.overflow="auto"}),(i,c)=>(r(),T(Y,{to:"body"},[V(M,{name:"fade"},{default:v(()=>[a.isOpen?(r(),d("div",{key:0,class:"fixed inset-0 bg-black/50 z-40 backdrop-blur-sm",onClick:p})):m("",!0)]),_:1}),V(M,{name:"slide-up"},{default:v(()=>[a.isOpen?(r(),d("div",te,[e("div",{class:"pointer-events-auto bg-white rounded-t-2xl sm:rounded-2xl shadow-2xl max-h-[90vh] sm:max-h-[85vh] overflow-y-auto w-full sm:w-full sm:max-w-lg md:max-w-xl lg:max-w-2xl animate-in slide-in-from-bottom-5 sm:zoom-in-95",onClick:c[0]||(c[0]=X(()=>{},["stop"]))},[e("div",se,[e("div",ae,[e("div",le,[e("h2",oe,u(a.title),1),a.subtitle?(r(),d("p",ne,u(a.subtitle),1)):m("",!0)]),e("button",{onClick:x,class:"ml-4 inline-flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-lg hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors flex-shrink-0","aria-label":"Fermer"},[...c[1]||(c[1]=[e("svg",{class:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",ie,[_(i.$slots,"default",{},void 0,!0)]),i.$slots.footer?(r(),d("div",re,[_(i.$slots,"footer",{close:x},void 0,!0)])):m("",!0)])])):m("",!0)]),_:3})]))}}),ce=Object.assign(ee(de,[["__scopeId","data-v-b8051d8d"]]),{__name:"BaseModal"}),ue={key:0,class:"space-y-6"},me={class:"flex justify-center"},be={class:"grid grid-cols-2 sm:grid-cols-3 gap-4 sm:gap-6"},xe={class:"space-y-1"},pe={class:"text-base sm:text-lg font-semibold text-gray-900"},ye={class:"space-y-1"},fe={class:"text-base sm:text-lg font-semibold text-gray-900"},ge={key:0,class:"space-y-1 col-span-2 sm:col-span-1"},ve={class:"text-base sm:text-lg font-semibold text-gray-900"},Ee={key:0,class:"flex flex-col items-center p-4 sm:p-6 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl border border-gray-200"},Ce=["src"],ke={class:"p-3 sm:p-4 bg-blue-50 rounded-lg border border-blue-200"},he={class:"flex gap-2"},we={class:"text-xs sm:text-sm text-gray-700"},Re={class:"grid grid-cols-2 gap-4 pt-4 sm:pt-6 border-t border-gray-200"},Oe={class:"space-y-1"},Se={class:"text-xs sm:text-sm font-medium"},Be={class:"space-y-1"},Le={class:"text-xs sm:text-sm font-medium"},$e={key:1,class:"space-y-4 sm:space-y-6"},Ve={class:"space-y-2"},Me={class:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3"},_e=["onClick"],Ie={class:"space-y-2"},je={key:0,class:"text-xs sm:text-sm text-red-600"},Te={class:"space-y-2"},Ue={key:0,class:"text-xs sm:text-sm text-red-600"},qe={class:"space-y-2"},ze={key:0,class:"space-y-2"},Pe={class:"flex flex-col items-center p-4 bg-gray-50 rounded-lg border border-gray-200"},De=["src"],He={key:1,class:"alert-error"},Ae=["onClick"],Fe=["disabled"],Ne={key:0,class:"spinner-small"},Qe=j({__name:"TableModal",props:{isOpen:{type:Boolean},mode:{default:"view"},table:{default:null},canEdit:{type:Boolean,default:!0},canChangeStatus:{type:Boolean,default:!0}},emits:["close","save","statusChange"],setup(a,{emit:E}){const s=a,y=E,x=k(!1),p=k(""),i=I({}),c=k(s.mode),U=["LIBRE","OCCUPEE","RESERVEE","HORS_SERVICE"],l=I({number:s.table?.number||1,capacity:s.table?.capacity||4,location:s.table?.location||"",status:s.table?.status||"LIBRE"}),q=h(()=>c.value==="create"?"Créer une table":c.value==="edit"?`Modifier Table ${s.table?.number||""}`:`Table ${s.table?.number||""}`),z=h(()=>c.value==="view"&&s.table?`${C(s.table.status)} • ${s.table.capacity} pers.`:c.value==="edit"?"Mettez à jour les informations":c.value==="create"?"Ajoutez une nouvelle table":""),P=h(()=>c.value==="create"?"Créer":"Enregistrer"),C=o=>({LIBRE:"Libre",OCCUPEE:"Occupée",RESERVEE:"Réservée",HORS_SERVICE:"H.S."})[o]||"",D=o=>({LIBRE:"badge-success",OCCUPEE:"badge-danger",RESERVEE:"badge-warning",HORS_SERVICE:"badge-gray"})[o]||"",H=o=>({LIBRE:"btn-success",OCCUPEE:"btn-danger",RESERVEE:"btn-warning",HORS_SERVICE:"btn-gray"})[o]||"",A=o=>({LIBRE:"Cette table est libre et prête à accueillir des clients.",OCCUPEE:"Cette table est actuellement occupée.",RESERVEE:"Cette table est réservée pour une période donnée.",HORS_SERVICE:"Cette table n'est pas disponible pour le moment."})[o]||"",B=o=>new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),F=()=>{Object.keys(i).forEach(t=>delete i[t]),p.value="";let o=!0;return(!l.number||l.number<1)&&(i.number="Le numéro doit être supérieur à 0",o=!1),(!l.capacity||l.capacity<1||l.capacity>20)&&(i.capacity="La capacité doit être entre 1 et 20",o=!1),o},N=()=>{c.value="edit",s.table&&(l.number=s.table.number,l.capacity=s.table.capacity,l.location=s.table.location||"",l.status=s.table.status)},Q=()=>{s.mode==="view"?c.value="view":f()},J=async()=>{if(!F()){p.value="Veuillez corriger les erreurs du formulaire";return}x.value=!0;try{await new Promise(o=>setTimeout(o,500)),y("save",{number:l.number,capacity:l.capacity,location:l.location||void 0,status:l.status}),f()}catch(o){p.value=o.message||"Une erreur est survenue"}finally{x.value=!1}},L=async o=>{s.table?.id&&(y("statusChange",parseInt(s.table.id.toString()),o),f())},f=()=>{c.value=s.mode,y("close")};return S(()=>s.isOpen,o=>{o?(c.value=s.mode,s.table&&(s.mode==="edit"||s.mode==="view")&&(l.number=s.table.number,l.capacity=s.table.capacity,l.location=s.table.location||"",l.status=s.table.status)):(Object.keys(i).forEach(t=>delete i[t]),p.value="")}),S(()=>s.mode,o=>{c.value=o}),(o,t)=>{const K=ce;return r(),T(K,{"is-open":a.isOpen,title:n(q),subtitle:n(z),onClose:f},{footer:v(({close:b})=>[a.mode==="view"?(r(),d(w,{key:0},[e("button",{onClick:b,class:"btn-outline flex-1 sm:flex-none"}," Fermer ",8,Ae),a.canEdit?(r(),d("button",{key:0,onClick:N,class:"btn-primary flex-1 sm:flex-none"}," Modifier ")):m("",!0),a.canChangeStatus&&a.table&&a.table.status==="LIBRE"?(r(),d("button",{key:1,onClick:t[3]||(t[3]=$=>L("OCCUPEE")),class:"btn-success flex-1 sm:flex-none hidden sm:flex"}," Occuper ")):m("",!0),a.canChangeStatus&&a.table&&a.table.status==="OCCUPEE"?(r(),d("button",{key:2,onClick:t[4]||(t[4]=$=>L("LIBRE")),class:"btn-success flex-1 sm:flex-none hidden sm:flex"}," Libérer ")):m("",!0)],64)):(r(),d(w,{key:1},[e("button",{onClick:Q,class:"btn-outline flex-1 sm:flex-none"}," Annuler "),e("button",{onClick:J,disabled:n(x),class:"btn-primary flex-1 sm:flex-none flex items-center justify-center gap-2"},[n(x)?(r(),d("span",Ne)):m("",!0),e("span",null,u(n(x)?"Enregistrement...":n(P)),1)],8,Fe)],64))]),default:v(()=>[a.mode==="view"&&a.table?(r(),d("div",ue,[e("div",me,[e("span",{class:g(["badge-base text-sm sm:text-base px-4 py-2",D(a.table.status)])},u(C(a.table.status)),3)]),e("div",be,[e("div",xe,[t[5]||(t[5]=e("p",{class:"text-xs text-gray-500"},"Numéro",-1)),e("p",pe,"#"+u(a.table.number),1)]),e("div",ye,[t[6]||(t[6]=e("p",{class:"text-xs text-gray-500"},"Capacité",-1)),e("p",fe,u(a.table.capacity)+" pers.",1)]),a.table.location?(r(),d("div",ge,[t[7]||(t[7]=e("p",{class:"text-xs text-gray-500"},"Localisation",-1)),e("p",ve,u(a.table.location),1)])):m("",!0)]),a.table.qrCode?(r(),d("div",Ee,[e("img",{src:a.table.qrCode,alt:"QR Code",class:"w-40 h-40 sm:w-48 sm:h-48 mb-4"},null,8,Ce),t[8]||(t[8]=e("p",{class:"text-xs sm:text-sm text-gray-600 text-center font-medium"}," Scannez ce code pour passer commande ",-1))])):m("",!0),e("div",ke,[e("div",he,[t[9]||(t[9]=e("svg",{class:"w-5 h-5 text-blue-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2z","clip-rule":"evenodd"})],-1)),e("p",we,u(A(a.table.status)),1)])]),e("div",Re,[e("div",Oe,[t[10]||(t[10]=e("p",{class:"text-xs text-gray-500"},"Créée le",-1)),e("p",Se,u(B(a.table.createdAt)),1)]),e("div",Be,[t[11]||(t[11]=e("p",{class:"text-xs text-gray-500"},"Mise à jour",-1)),e("p",Le,u(B(a.table.updatedAt)),1)])])])):(r(),d("div",$e,[e("div",Ve,[t[12]||(t[12]=e("label",{class:"label-base label-required"},"Statut",-1)),e("div",Me,[(r(),d(w,null,Z(U,b=>e("button",{key:b,type:"button",onClick:$=>n(l).status=b,class:g(["btn-base text-xs sm:text-sm py-2 sm:py-3 px-2 sm:px-4 rounded-lg transition-all",n(l).status===b?H(b):"btn-outline"])},u(C(b)),11,_e)),64))])]),e("div",Ie,[t[13]||(t[13]=e("label",{for:"number",class:"label-base label-required"},"Numéro de table",-1)),R(e("input",{id:"number","onUpdate:modelValue":t[0]||(t[0]=b=>n(l).number=b),type:"number",class:g(["input-base",{"border-red-500":n(i).number}]),placeholder:"Ex: 1",min:"1",required:""},null,2),[[O,n(l).number,void 0,{number:!0}]]),n(i).number?(r(),d("p",je,u(n(i).number),1)):m("",!0)]),e("div",Te,[t[14]||(t[14]=e("label",{for:"capacity",class:"label-base label-required"},"Capacité (personnes)",-1)),R(e("input",{id:"capacity","onUpdate:modelValue":t[1]||(t[1]=b=>n(l).capacity=b),type:"number",class:g(["input-base",{"border-red-500":n(i).capacity}]),placeholder:"Ex: 4",min:"1",max:"20",required:""},null,2),[[O,n(l).capacity,void 0,{number:!0}]]),n(i).capacity?(r(),d("p",Ue,u(n(i).capacity),1)):m("",!0),t[15]||(t[15]=e("p",{class:"text-xs text-gray-500"},"Entre 1 et 20 personnes",-1))]),e("div",qe,[t[16]||(t[16]=e("label",{for:"location",class:"label-base"},"Localisation",-1)),R(e("input",{id:"location","onUpdate:modelValue":t[2]||(t[2]=b=>n(l).location=b),type:"text",class:"input-base",placeholder:"Ex: Terrasse, Intérieur, Jardin..."},null,512),[[O,n(l).location]]),t[17]||(t[17]=e("p",{class:"text-xs text-gray-500"},"Optionnel - Aide à identifier la table",-1))]),a.mode==="edit"&&a.table?.qrCode?(r(),d("div",ze,[t[19]||(t[19]=e("label",{class:"label-base"},"Code QR existant",-1)),e("div",Pe,[e("img",{src:a.table.qrCode,alt:"QR Code",class:"w-24 h-24 sm:w-32 sm:h-32 mb-2"},null,8,De),t[18]||(t[18]=e("p",{class:"text-xs text-gray-600"},"Code QR actuel",-1))])])):m("",!0),n(p)?(r(),d("div",He,[t[20]||(t[20]=e("span",null,"⚠️",-1)),e("span",null,u(n(p)),1)])):m("",!0)]))]),_:1},8,["is-open","title","subtitle"])}}}),Ge=Object.assign(Qe,{__name:"TableModal"});export{Ge as _,ce as a};
