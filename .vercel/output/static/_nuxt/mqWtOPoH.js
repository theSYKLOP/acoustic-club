import{_ as k}from"./CiWreWkq.js";import{u as R}from"./DrqiWn2U.js";import{u as T}from"./BZIEon5x.js";import{e as O,h as v,r as B,m as V,n as L,c as u,a as e,p as I,l as g,t as i,k as s,q as b,F as A,s as H,o as c}from"#entry";import"./DlAUqK2U.js";const M={class:"min-h-screen bg-gray-50"},P={class:"px-4 sm:px-6 lg:px-8 py-6 sm:py-8"},U={class:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},$={class:"text-sm text-gray-600"},j={class:"mb-8 -mx-4 sm:mx-0 overflow-x-auto sm:overflow-visible"},z={class:"flex sm:flex-wrap gap-2 sm:gap-3 px-4 sm:px-0 min-w-max sm:min-w-0"},F={key:0,class:"flex items-center justify-center py-20"},N={key:1,class:"text-center py-20"},q={key:2,class:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 sm:gap-4 lg:gap-6"},D=["onClick"],G={class:"flex justify-between items-start mb-3 gap-2"},J={class:"text-base sm:text-lg lg:text-xl font-bold"},K={class:"space-y-1 text-xs sm:text-sm"},Q={class:"text-gray-700"},W={key:0,class:"text-gray-600"},re=O({__name:"tables",setup(X){const d=R(),n=T(),l=v(null),m=v(!0),r=B({isOpen:!1,mode:"view",table:null}),x=V(()=>l.value?n.tablesByStatus(l.value):n.tables),E=a=>({LIBRE:"border-l-4 border-green-500 bg-green-50 hover:bg-green-100",OCCUPEE:"border-l-4 border-red-500 bg-red-50 hover:bg-red-100",RESERVEE:"border-l-4 border-orange-500 bg-orange-50 hover:bg-orange-100",HORS_SERVICE:"border-l-4 border-gray-500 bg-gray-50 hover:bg-gray-100"})[a]||"",y=a=>({LIBRE:"badge-success",OCCUPEE:"badge-danger",RESERVEE:"badge-warning",HORS_SERVICE:"badge-gray"})[a]||"",h=a=>({LIBRE:"Libre",OCCUPEE:"OccupÃ©e",RESERVEE:"RÃ©servÃ©e",HORS_SERVICE:"H.S."})[a]||"",f=()=>{r.isOpen=!0,r.mode="create",r.table=null},C=a=>{r.isOpen=!0,r.mode="view",r.table=a},w=()=>{r.isOpen=!1,r.table=null},_=async a=>{try{r.mode==="create"?await n.createTable({number:a.number,capacity:a.capacity,location:a.location}):r.mode==="edit"&&r.table&&await n.updateTable(r.table.id.toString(),a),await n.fetchTables()}catch(t){console.error("Erreur lors de la sauvegarde:",t)}},S=async(a,t)=>{try{await n.updateTable(a.toString(),{status:t}),await n.fetchTables()}catch(p){console.error("Erreur lors du changement de statut:",p)}};return L(async()=>{m.value=!0;try{await n.fetchTables()}catch(a){console.error("Erreur lors du chargement des tables:",a)}finally{m.value=!1}}),(a,t)=>{const p=k;return c(),u("div",M,[t[7]||(t[7]=e("div",{class:"bg-white border-b border-gray-200"},[e("div",{class:"px-4 sm:px-6 lg:px-8 py-6 sm:py-8"},[e("h1",{class:"text-2xl sm:text-3xl lg:text-4xl font-bold mb-2"},"Tables"),e("p",{class:"text-sm sm:text-base text-gray-600"}," Visualisez l'Ã©tat de toutes les tables en temps rÃ©el ")])],-1)),e("div",P,[e("div",U,[e("div",$,i(s(n).totalTables)+" table(s) au total ",1),s(d).isAdmin.value||s(d).isServeur.value?(c(),u("button",{key:0,onClick:f,class:"btn-primary flex items-center gap-2 w-full sm:w-auto"},[...t[4]||(t[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",null,"CrÃ©er une table",-1)])])):g("",!0)]),e("div",j,[e("div",z,[e("button",{onClick:t[0]||(t[0]=o=>l.value=null),class:b(["btn-base shrink-0 text-xs sm:text-sm whitespace-nowrap",s(l)===null?"btn-primary":"btn-outline"])}," Toutes ("+i(s(n).totalTables)+") ",3),e("button",{onClick:t[1]||(t[1]=o=>l.value="LIBRE"),class:b(["btn-base shrink-0 text-xs sm:text-sm whitespace-nowrap",s(l)==="LIBRE"?"btn-success":"btn-outline"])}," Libres ("+i(s(n).freeTables.length)+") ",3),e("button",{onClick:t[2]||(t[2]=o=>l.value="OCCUPEE"),class:b(["btn-base shrink-0 text-xs sm:text-sm whitespace-nowrap",s(l)==="OCCUPEE"?"btn-danger":"btn-outline"])}," OccupÃ©es ("+i(s(n).occupiedTables.length)+") ",3),e("button",{onClick:t[3]||(t[3]=o=>l.value="RESERVEE"),class:b(["btn-base shrink-0 text-xs sm:text-sm whitespace-nowrap",s(l)==="RESERVEE"?"btn-warning":"btn-outline"])}," RÃ©servÃ©es ("+i(s(n).reservedTables.length)+") ",3)])]),s(m)?(c(),u("div",F,[...t[5]||(t[5]=[e("div",{class:"spinner mr-3"},null,-1),e("span",{class:"text-gray-600"},"Chargement...",-1)])])):s(x).length===0?(c(),u("div",N,[...t[6]||(t[6]=[e("p",{class:"text-lg text-gray-600"},"Aucune table trouvÃ©e",-1)])])):(c(),u("div",q,[(c(!0),u(A,null,H(s(x),o=>(c(),u("button",{key:o.id,class:b(["card-base p-3 sm:p-4 lg:p-6 cursor-pointer transition-all text-left",E(o.status)]),onClick:Y=>C(o)},[e("div",G,[e("h3",J,"Table "+i(o.number),1),e("span",{class:b(["badge-base text-xs",y(o.status)])},i(h(o.status)),3)]),e("div",K,[e("p",Q,"ğŸ‘¥ "+i(o.capacity)+" pers.",1),o.location?(c(),u("p",W,"ğŸ“ "+i(o.location),1)):g("",!0)])],10,D))),128))]))]),s(r).isOpen?(c(),I(p,{key:0,"is-open":s(r).isOpen,mode:s(r).mode,table:s(r).table,"can-edit":s(d).isAdmin.value||s(d).isServeur.value,"can-change-status":s(d).isAdmin.value||s(d).isServeur.value,onClose:w,onSave:_,onStatusChange:S},null,8,["is-open","mode","table","can-edit","can-change-status"])):g("",!0)])}}});export{re as default};
